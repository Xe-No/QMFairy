[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=187112ee-d57b-46ff-8551-1271c5b448ad
Description=采集遗迹【世界A】【上空式】【世界级】【内存】_自动备份
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=2
QUI=
[Relative]
SetupOCXFile=
[Comment]

[Attachment]
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


[UIPackage]
UEsDBBQAAgAIABqlV0i6KC/H3AIAAAgeAAAJABEAVUlQYWNrYWdlVVQNAAe9w8xWvcPMVr3DzFbtWE1vUkEUPQNIgQKltMUWP8LCHyBuujFG29ikCdUG0IUrsUUl0kcDNLY/x3+gK1emLo0ulF+gJm6MOxfuBO+8N69MG6lvZp591nBeLsPHG87Mnbnn3nlhOPjwfvrTsxf5zziCawijP4gjKn3HhNnIACHxuT8YDNyvB2OcKvwki4g15Gt9hmyCLEEWI4uTTZKlyJLivv7Ybf8NymjR1UUBN2FR28YeVJCjHeP+F/vDvet7H+8vWj0WpvevhbDcwSouQx8xMObyh0bcc73s8Lr88m/LqKJkMIKE4J8SsXMcv9vKv1XJ39uo4xZq2KJWFVlSYXk9vfaLiNaN55OwMf49rLTaWwbhB96/aNCfwQym/U3xrtd7/vLV/lfd/goh+1f66+rOUP/U9YdJWsmzTg0P0NQcQxohNilqFq/8IUn/7qKBDpnuCDLEn8Sw7vXSJyzxl4m1hk3cJj80FXOv0H8WhVOveeWPSPxV4t+lvG+w/kx1/fnax8T7Zao+mmRtzZHMauy/qDT/If8SrcMGnqjz2/VMXMH/E0fWf8PQ/ynhT6/8MXvfHsZjCspdnD78+P2c7bSwVilUalanUKm3Gw9H9F+1tne6Sy3tqbv9dXNg0PnvHilPm/SnTq86SGvEX1za/yWKPfWoO7z/0+L/vPInJP4V4rfM4k95/jxfXT3QH37+KBrwswP+7Ih7jjv/+HD+sPX/vIL/kxjqfxD1R0rsQQ4/6o958Dzgff5p+Ft/LFB7QYF/Cv7WHzPUnlXgzyDY+mMaTg524s+4/rD5LyrMPwtf6w/bnzkF/hmJ3xRvv7z5tv+9iKBgev65QnaJbJHxXKCOoM+fpvWPH/Vnnto5hf03i2H9GUT9MQd/649zQlO88ucQbP3BtdqtP26Q+jTwiMbAs7B1IueveWn+66R6Hbqe2hq4qTx/neefCxL/GnbIA13yQYnMUs7BOvPPwz/9FRqo/Px3jDE4fgFQSwECFwsUAAIACAAapVdIuigvx9wCAAAIHgAACQAJAAAAAAAAAAAAAIAAAAAAVUlQYWNrYWdlVVQFAAe9w8xWUEsFBgAAAAABAAEAQAAAABQDAAAAAA==


[Script]
//UserVar WorldName = "WorldA" "世界名称"
UserVar WorldName = DropList{"Eden":"WorldE"|"Tinker":"WorldT"|"Pelago":"WorldP"|"Spyre":"WorldS"|"Aspen":"WorldA"} "世界名称"
//WorldName = "WorldA" 

UserVar 进入世界后等待时间 = 1000 "进入世界后等待时间"
UserVar 完成采集后等待时间 = 1000 "完成采集后等待时间"
UserVar 离开世界后等待时间 = 1000 "离开世界后等待时间"


Reap_Array = Array(377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 618 ,619 , 620, 622, 623, 624, 625, 626, 627, 628, 629, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642)
//621 is conflicted with 106(SandBlock), Finding with ExMethod.




BreakPoint = False
Cave_Sub   = 377
Cave_Sup   = 388
Fossil_Sub = 405
Fossil_Sup = 416
Glyph_Sub  = 618
Glyph_Sup  = 629
Trilo_Sub  = 631
Trilo_Sup  = 642

Call Lib.CC.Initailize()

//dm_ret = dm.BindWindowEx(handle, "dx2", "dx.mouse.position.lock.api|dx.mouse.position.lock.message", "dx", "", 0)
dm_ret = dm.BindWindowEx(handle, "dx2", "dx.mouse.position.lock.api", "dx", "", 0)

Delay 100
Dm.SetPath "C:\Users\Administrator\Documents\DmRes"'大漠全局路径设置


Rem Start
BlockCount = 0

For Index = 0 To 100
Call TPMine(WorldName,Index)
Call JumpForward

Call WaitInnerWorld
Delay 进入世界后等待时间
Call Hunt
Delay 完成采集后等待时间
Call WaitOverWorld
Delay 离开世界后等待时间

Next


Sub TPMine(WorldName, MineIndex)
Dim MyString, MyArray
MinePos = Lib.文件.读取指定行文本内容("C:\Users\Administrator\Documents\DmRes\" & WorldName & ".txt",MineIndex)
If MinePos = "" Then 
//EndScript
Goto Start
Else 
	MyString = Split(MinePos, ",", - 1 , 1)
	MineX = CSng(MyString(0))
	MineY = CSng(MyString(1))
	MineZ = CSng(MyString(2))
	
	返回值 = Lib.CC.TP(MineX, MineY, MineZ)
	Delay 3000
End If
	
	
End Sub


Sub JumpForward

Delay 200
dm.KeyDownChar "W"
Delay 16
dm.KeyDownChar "Space"
Delay 219
dm.KeyUpChar "Space"
Delay 31
dm.KeyUpChar "W"
Delay 200

End Sub


Sub Hunt

Call Lib.CC.GetSubAddress()
Call Lib.CC.GetWorldSize()
Dim reap_block

For Each reap_block In Reap_Array
Call Lib.CC.ReapBlock(reap_block,"down")
Next

//Dim index
//For index = 0 To 15
//Call Lib.CC.ReapBlockEx(621 + 256 * 8 * index,"down")
//Next

Delay 1000

Rem SkipHunting
Call Lib.CC.CubicClick(handle, 1256, 22)
//Delay 200
//Call Lib.CC.CubicClick(handle, 560, 536)
//Above Confirm Cancelled
Delay 100

End Sub


Sub WaitInnerWorld

Do
Delay 1000
Loop Until Lib.CC.GetGameState() = "Realm"

End Sub


Sub WaitOverWorld

Do
Delay 1000
Loop Until Lib.CC.GetGameState() = "Main_World"

End Sub


Function AdrToPos(adr, off)
	Dim Arr(1)
	Arr(0) = adr
	Arr(1) = CStr(off)
	PStr = Join(Arr,"+")
	AdrToPos = dm.ReadInt(handle,PStr,2)
End Function

Sub OnScriptExit
	MessageBox BlockCount
End Sub
