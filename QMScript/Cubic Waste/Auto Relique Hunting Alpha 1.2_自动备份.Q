[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=af4a3c1d-61f1-4f4b-a6bc-b8db16224575
Description=Auto Relique Hunting Alpha 1.2_自动备份
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=2
QUI=
[Relative]
SetupOCXFile=
[Comment]

[Attachment]
UEsDBBQAAgAIAFwp/kaXgMERjQUAALwGAAAKABEAU2t5TWFwLmJtcFVUDQAH1rG5VdaxuVXWsblVXZXpT5RHHMdtX/RlD+vVkiIqJRRR5NrlFEWQK+CZWpP+Be2L1qSx4O4+1z7XLuxyLMuNGgQVIxSLjSYYKAuLgFZRDCUQr3IsLrD38+xz7NF5dmm1nfwmmcw885nv9zuTPLmlvR9sCjUZ6LGg7wB9O+jvhUabNpVvrL/bXi1ML1j+XLbOr6y9tNper7tWHMyaW3AxIsv6eK9f9Pp9XDDABYPh4oN+LuD3+gVW9HoEt5uzO1mrw7O0aJm3WF9Y1xfW7Ms2l9XFOjwcw/lFIRgQgkEPz3J+Hx8MChsVEN6OpeLBQSLnFTwr1r9W1y3rDqvDve5mXAzY6BPFYDBcqw4LwzNCwA/GQiAQHvyn/CIvcmLAt2ZbtTltTrfTzXoYzsuJAu/z+YJBUGIg8HppZmH5GcPaeJHhODsnuMWAP7waLl7wsMyKILJ2u93lcrkZxsOyLOflRUHw+fwSxO9mHZOP+u4P617PdK08v22Z711fNvO8yxcIgA/8gYDPz3vs89ZXd932uTDH4wEYj9fLCgIv+kS/3+dyW59M3+2+8dOdKwV/9BRO3Tox1XdsduiHtVcDPGv18S7Bu+6yTi1MNcwOnrPM3ghzXE47w7g5jhOBL4G3OyyTD3s6rp6rqSu5ZkwZao8zX4q9f/mria6Up7fPvpygFp+2Lkw1zpnOP+4rfdRTOD9SDjhOh8Nms7Isw/O8GGpvrM9/6ccra8oI7RGdNr2zNv5uU4ypbY+5fY/5Ysx4Z+KDaxmTV+XjV5ImulInr2U+6T8t6XE6QDxerxdwBEHgOPbFy4cdV3/U6osw+jCMZ6O4vI7ed7M2erB5p6k1crRtl7k9euxSzNjlvfc7EiY6Ux50H7TZbMAVwzBhDsO4FhZnBgaNhsYzZGUuSuVAeJZKna5AUnEsoUMXfa8xYrglwtQSaWrbPdIeM3opbqwjYbwr1fpmyeUK6wEXxkw/G+r9lWho/ZaszFfTOSiZDeGZSsBB5RVwMo7Gd+qi7tRH9Bt29tRF9xhif2uKG7oYP9ZxYPqZ2bpqASi327m4NHezj6g2nKaq8nD6EEJmw0QWhGeoQpwLSOoFOJnE4mvIWB0RR+H7aTyxhk7sqku4157Q1Y0/fDwwN/94Zna8/46h2vANrsnDNYdQ6uAGBM+A1TIVKlOisgtoqgJNAcIAU4HIFIhcicpxQna9/gClP2ts/q6943xD2/ca/WmUOgqyBY4QMgvGM4ESFSZH1SkwlgI4CoACqhAAlCkxuQJLU6BpANWkS1LTJ3HNMZQqhclimDiKELkYmYPR2QiZCeEAkqbE0gBK2iVZk0kyJGB4BnCk+XptosShAaQEIgohPB/BD6NkjprOQogMSC1BwHGhCm2XIKnKkKmQsBQFnAwhiW26eIw6CcRARLGKKICIfITMxehDGAUSTlepQ0pCHLBdCgcQYCmfcjipAjoAwftwNK6eir1liEapEzC5wQG+MDof1x7BNTlAzwYHCxuROBVIcgWU9LMqoVy5l0C+bKUie6sjBowRw82RGHUcJkpVeBGEF6BUIVFZTOkKpBdIZgLIvxwAAS4q4KRySIJokKhu3fYh42ZT05aR5h2jrV+g/3BUxFGULqL0pZrqEkp3BKPecpRhMcAOlFiu2qdFo7qrtgwaPzY1As7W/3FgshDTlGj0x6tqyjT6PIwGjycdJBOihVBwMnAE7Fyv3DpY/+GwxPnU1LRtpOUzc9tOkDNClkHgvshitbZUW3tKbzheWVOEaw6jUtqZsDodUstVIGRYSkaP77pdu/n3ho+GjZ+YGreMNm8fbYkwt0ep6VNAEkKXYpoyWn+y2nimvulrQ9OJytpisipPDR42kYmo5RAG8gGc/Rp0962abcMNm0ebw2I+N7dHjl3c8+4/KPr9vwFQSwMEFAACAAgAMin+Rkq8TiWgBQAAvAYAAA0AEQBFeGl0V29ybGQuYm1wVVQNAAelsblVpbG5VaWxuVV1lftv21QUxwc/8C/ADxMgVsrWNmmaNI7tOC87iWPHcf2MnSbN086radNXmrZJu010Y1tHyhhqhcQkNsRgoE1sU7dJ7IchQCA0BgzBJNAYZb9MA5WKdbCOCbjt+KFD4+rcq6trn8/93nPOtfHQicc2rTcI9K2gPwH646A/sj7btGns3+cbm1tM8fkJqXdSKk2y2Sqh5lxSioyVmMxwSKuw+ihYDGUrjF4JZUfZ3No8qA0F4n1EJEcl+oXihNy3XRmctjNqMF5mkgNMajAQK7mEBKHowL0rW2W0kftGpweBS6Cnj+wpBXpKZKyXULNuOUPF+8ViTS5Nhft3WgkVl9LesEZGCmS0SIQ1sBfgBFODVLxMrvv6o72+SMGr5gglh69Z1iWmXUKKjvdzeoWOFanuvAVrQP4oQsluPuGVNY+YJML6mmN3Yd03TyhZ4IiHgQDNJWYAwSmksK6Yg436FN2nAmbSKaWs0EVj53YDwlq9HMaoKK1goSgIkVtKe6SMWwKOKSefdPAJjEvY2R40FEWZqI1SIB+HBcP+5AA30eCnXkGQZQj63tAx12KRTXba5KDMHhYOyCgdWbNgBKEjcCAMkTLkByZBpITQYDsV9nY5grJS3Td47MP84fcBB0FuwfDPHZZTW9tTzSbXc2aH0R4ANAveZSE4q0+0+SWYlDGm27N29gzVXWSTgzQ4tZiQ++rlubczew/d56DobRRdsXR+1rStvLkJesZga7F5TC7a5hdcbMwnaXR3L5ceVooTaqkugxwV6rxWDahZn5gIduvBaH4D547dvgpB17a2Nra0kAbYhwYkUtG59JCcG1OKtXCxJubGg4kBEHOnAOKm+dQC0EaGdaBtA+cPu/2u3f4ngi5boAUTkkfJiFdaqwe/WvBIOsL2mP1yq4NtdYTaPbzZJ4NFITce7p2SCvUHOauAY7ffAyNk+9LQubPVJhsctBnnOwjJ5BU7ScXFpgJKwcklLX7ZI2pCtioX63Jh8qEcDPsbw/6C0RsmeN7kYhyhaCjWHylMagO7huuzQxP76UgR6MFlndcqIkD9jx4AwbBVzLGIB46QUpqUM1p5cubAoSNHj7938vTLB+focMqIS7ic5dIjYnZMLj5UD4jSLczxMRXaHc8M81HdyShjO56/ePGj5eXrvy39cPL4G7QcN3hEEHCQRFEHemr/4YDRBl/HHMeiserefS/Mzx9IZvOwj9vT2L+4+PVP16+cP39qrF4DZCsVAfkCegStIj3A+R1Fb5k7L7UYahwXfnVu9oML50+ffjdb6rO42XAyVx6dkJMFlFKtfhUJxuyhGMgjr41yWkXIT9znIMgKDP/S3rHwZJOypdWsRNSZmV37ZhvZcoXo6rYQQodHaEM5o0P08rqUGsLFtIWUCSUP8sXpVZD9dc6yzfajseO1pjZmixFugXDYyzmoMEqq9mAcDUbBpRB6eqemXzr85jtnzizMzc+TYnybgwVxBkEW9KqUrwEZndClVtNUa6evHSPbUL/Z0+UVM0pmeGhi947ds2qqBBFd9Z3TV7+7fO/uyu2VpbNnTwSkWDMSdIsaOJewnncLdMFoLbejXsQvgltscDKwXxwZ33Hu3NmrV6989cUnI9Vxqyu4p9G4efPar0s3Ln3+6UxjP0aL2zDGJaT5TEXKg5Kum+3DCClitIILKTefbnN2oaQwN39w6ebi6uqdb769PDRWs7iZZKF/b+PFSm1KiungBYMj2IFzbiHNZdaSBUra6gkRYppUsnS0iMuawcXBfmH79PTCmVOvH32rXJ3E2YjRyRgwqtmKP9XufNqMt2AhG6W6+WQgWmTTw2y6QicG7aRMRYrBnr5QchDUg9krtTsZ1C9AOPusxbO5DWu2kRaCN3k4o5u3UlGXoJHdJSY1xKSGqfgA+PgHYr2kmt/4D2p69B9QSwMEFAACAAgAUCT+RtGB30BgAQAA9QIAAAoAEQBXb3JsZFQudHh0VVQNAAdAqblV/HW7Vfx1u1VVUlmq40AM/Df4Jm2hpbXd/2Kv1E6GDIRgJNUmtTB5dPcSIbf5eCijUbovaSqd0hay6q71yEzjd1/m5Dq1HRR2mgNM1bgv38Q9NU2qXI9Ru1TIfWWRnGlvEj56PZzadl+txIcTZvqfmcqyF7j/R0GqIdZCG+5yuZP5hw8+EACV6qUMtvU4BbOZTd0odO2mYTKSFomZB1XupQXUEUHctJ2AqBn5wkZMvh2ImE5nk9nypMiflmJHqtDplUNzWkoWoTYtLupAUCfxn50rM9kSDkDeeU+Hs0KSjXGlPJuGdO09DSPNFfivdx6bTtQDmwKRFPkHUIX9yzbi0WVi/wDsZJ9TvQD4GoAL2zDBYqx00maWF5Kc8ApPh0on/0uVDE/IWz6zovolq9SYK5Ixvy1cTX+DF9l5bCf7xxo2GpNxRnsfrL5XYU90LGhjv/X1hncGOkPOwjnOQ2l86LyOufOcDFp/UEsDBBQAAgAIAEIk/kbntq5nFgEAAFsCAAAKABEAV29ybGRTLnR4dFVUDQAHOam5Vfx1u1X8dbtVTVJJkuQwCLw7wj9REWKH/3+sE3nKUz7JoFxIxE3V+BYXma8PZXTg/77UqHhxktZTzq12X9KUuWKTycA+QhrZwffFLFSLDYXTeTCd6OygLcuU1NYn5oIIJNiY3Jcosb+QGHF2o/AFD6ndMICL0cYFA4Izj47pV4THmAVFLynq+iULtFRIcmWT12EDbZi6DJtS2OLt5DaYlN5xGnHmRwDJrw7qG2711Ct/8+Iq2shxJ8kLGAQnMhomRe3bMJkhES4QM9A7Sg7CnFiA2MT/NJK3TsRNAXHk6f6aGgRUj1ts8V3XzFdMpXsPGRN/5bkRWDR2CC4dyhOwV/h9OSDYo2w62uBRxhI16GFp+x3i/3uADD/vYVr39QdQSwMEFAACAAgAOCT+Rg8L6nvgAQAA+wMAAAoAEQBXb3JsZEUudHh0VVQNAAcYqblV/HW7Vfx1u1VNk0uOJDEIRPcp5U1cyPzh/hfrwK6enl0KDBE8SAnS3d1LisrXhzI6ut9HmqQnoUWOr1ofpQ7x4PexQGypkiKcxFGZCOcE5ilvSp7iD6kxvgxJJ79KQllHKU2q3ieUqvbmpU7zAkm8dYny96mguj6aTE9PgYppyfvwTlJZXJQ5HdNK1W/ceKyLXd/hnhN3ilrONEPeVqlV8M4CIV3ClHKdYyQWgT/GoL5MKXR9mDyse8TDiRcjPNrKZR2j3dNiMWbx0eYBGvd5+nI45jMjOsGwDuu90ckMb29F7pywCsBMvP27ADTLDZhiTp3Dmf24nWbGmydlAIWUgf1daBbrtMOuezFjeflN8GxGmEl9ddLWgyTU1O4kGFDkrBk8NJKHRwYFHwVcwSkIHQWGK4wwKC1ORUlaTwI7X0P/u3lMcaBzz4Qs8PrPko4ETG5A3EXN34Tq2SCYyJFgPdi37g3tLEjvU5N3Ixm1e2MjGEN1ABZOVebQzhZLHFsMoe6J4dW+mOF7Ww9L32QOYqj7tbcDLkDy2Aaxc+Oc5TKIcV59xrF7E47bnZswklzFB/DfL2ZjNGC8/kxloT9uzWN5k9/MuYlz2Wr4HZbV6F9DHeDlMgUlv7/IJTmW0gjDIIajZ/0f/g9QSwMEFAACAAgATCP+RneUxU+yAQAA3AMAAAoAEQBXb3JsZFAudHh0VVQNAAdup7lV/HW7Vfx1u1VdUluOw0AI+6/Um0zR8Ib7X2zNJNt2N19RHLCxLUXd3rrYqM001osyOrqfj9hku7cvxguHfUHpVI1nsVLVF8DMxJgA7qq6Xkw+UAKypLKFH/pmaWl/PgTUwYuFLM4IpUmWBSCMxEizupHoXYVlIkKiSzdpq0KaEgcOOfuaTJYVhd0QBHgC4mosX9JUeaTl9m0jraiWFLmr5S16JKuS2FKn9LNqBGQIVnVR1lKouEiEdO6E6FDatTcvCer9AXPzXATZY9yQxT8QZnoOCOc9PvZl6vNhTArPa7lStuPCm9Nguziprxo3Zv4vYW5zX90UgojPTre6+C73GJYFs34FaZsyh47H6fvyPRsTVtfJHkj/Dd8p9GyTfH8/PhoxaLZQ7PdZ5gXIbcI4o/GbcZbDSG4wAQlSu5FK2TLpF+0Lku9aCkyyPUxc6Az3vU7klAnnjg1s7zJdU+h382on8b3ljUwx8pxYSSJn6NTMdI6Fp4ES8ER9fb9ChD9aKHrAU9XRgAMcTZihRIruvXycgtwziTRyJkGDAVm54XBJ/IInRgixVUxyteYqxpUwjvble9r7gZ6PH1BLAwQUAAIACACUIP5GbGSr6+oBAAB9BAAACgARAFdvcmxkQS50eHRVVA0AB1qiuVX8dbtV/HW7VVVTSY7jMAy8N9A/UQjuy/8/NsXY6XHggw2VKdZCelNOmhxhEtHQ86LCyczvTxqFz/TRouwH0ElcpXVEycZiHphwEavGXhjdiQuFIjxYAAZT5tgRIZexvEBrV4BlNKNylhK3zxc4AbB1W7pm9RNUVmIGnSYeu9mUcmydUpn7USFuCXvXAQ1HnTulnEA1iqAF50tTHUVjfVpQ3OpfILrMTJ5cRmb6BGXQxqqOFxXPqvfLGrSTxndMHRtqizivvAptxTd12bFeR8W/sSRn7+PozNzQYCQRwn1dCjUHzkoBXAzapeIqzEAWMdAhbncWLX6Bqkg+m0IGnD8gME8aOSVkvANweYYHUAq1vyXMx0uc2lLcc8ObXZ4QI2vX40LJpc8qZQzSuyZvwSErGCGPIyuUcjAcu8DLRW4Slz7moCCqX6AY2DX8h/Lc3F9xidoZkiKdhmIwai57zhDcwOSUk9pM/SkGy+XfSPw0WNl+/BeAQGJPRJzEHgCWwD+ARh7+/cFQ9f3zIEeze2t6bUVC191LEibY30qBWwQldgabBbZ2z1skEm6o001IJOhTNP4On4O0kcS2Y38u9vbIwJAtO/z+hWFyEzTg8t+y+FvRmhd1Idr2tEgZ04frdg/jQ6MQ5q4LVt4Q1yDlLs1Hr39QSwECFwsUAAIACABcKf5Gl4DBEY0FAAC8BgAACgAJAAAAAAAAACAAgIEAAAAAU2t5TWFwLmJtcFVUBQAH1rG5VVBLAQIXCxQAAgAIADIp/kZKvE4loAUAALwGAAANAAkAAAAAAAAAIACAgcYFAABFeGl0V29ybGQuYm1wVVQFAAelsblVUEsBAhcLFAACAAgAUCT+RtGB30BgAQAA9QIAAAoACQAAAAAAAAAgAICBogsAAFdvcmxkVC50eHRVVAUAB0CpuVVQSwECFwsUAAIACABCJP5G57auZxYBAABbAgAACgAJAAAAAAAAACAAgIE7DQAAV29ybGRTLnR4dFVUBQAHOam5VVBLAQIXCxQAAgAIADgk/kYPC+p74AEAAPsDAAAKAAkAAAAAAAAAIACAgYoOAABXb3JsZEUudHh0VVQFAAcYqblVUEsBAhcLFAACAAgATCP+RneUxU+yAQAA3AMAAAoACQAAAAAAAAAgAICBoxAAAFdvcmxkUC50eHRVVAUAB26nuVVQSwECFwsUAAIACACUIP5GbGSr6+oBAAB9BAAACgAJAAAAAAAAACAAgIGOEgAAV29ybGRBLnR4dFVUBQAHWqK5VVBLBQYAAAAABwAHAMoBAACxFAAAAAA=


[UIPackage]
UEsDBBQAAgAIAOqkLEd74TNjwwMAAAgmAAAJABEAVUlQYWNrYWdlVVQNAAeZjfRVmY30VZmN9FXtWE1PE0EYfrdFaAuUFqF8CuVb8YJevBgTSySSABpaPXgwqYhCLAvZFq0HfwxnL3owngxXowfhF6iJF2O8ePAm9ZntrJ02EHZmtqxNeJqXaUtnn5l33s8JUhl7n+Jfdl73f6UaXKMgHZTC1Cx8Z3CxESMK8M8HpVLJ+bp0iobCH0gTP0N21mcgLZAwJASJQNohrZA2SLR89NQBifN5B6dqbFgs0yZeBUrSDTIxWvScZJCAxTjPMo757cz25xfDP/eMIHHDAu7QPM2QOkJkGA5/4BheZxT/N0sZWtBYQYTzJ7jvyPJnoO8tWqUlytIGRll0UsDmj/PY63ZeEx8d//1f5RT1xdymtaHhfsTmX9KYb5AedOfr4uP+/qu373a/q86XcNm6zFeNO5X4F6iq+dyemRMrWdbJ0gPKKa4hivjXytOJW/6AEP/u0jrlIaoriCnsPyjwL4M1Sw/pFvSQk8y9Tvxv4890y98k8GfAX0Te1zh/Q3b/7OxD/P0sqo8cxFJcSZcCf7Ow/wp/CuewQk/k+e16uUNC/y0157+iqf92rk+3/CEq1/Ai1uCURWo8tPjM//twndtpaTGdTGfNfDK9aq0/qhP/xMv7WvPvIfJYiD+r+KsCFn+7uU+5tb+wYP8L8D15r6u2/xh/nlv+yKH+n8Y61qAHuWzYC/8/SywOu+dvFfivo/rfsnOABTGxBrkslMD+w1Tuy93ytwn8c9i7qRd/pPMfi1dX/+0/h+z7GGtgejdV4r80f7Tq/LPQfwFrYHpI2efgZIKKbRyN8wr5p0PgT9nPL/ufG75D7M/oosq9m5s5MYFfN37o1p+6mDe3tgupzaLufNUeptH7lwwsv2DXvirWZ8cfaf+LC/Z3G/xFsOdQhasgqsDfWeX/7P5HvYON4AQd7r4jfnMS9z8T5D7+s3zl1N9+9H8sXoX5ey/6v2GMQxL77yZP+z8jiXFSgj9B3vZ//Rh7JPh7yN/+r5cqdbsH/Z+0/fWRt/3fAMYxCf33k7f93wjGQQn+Aar0fx++vf+x+0vnBk8PuvXDZcg45IrBall5+J1/gz7ze9D/SfvfIHnb/43zmOKW/xx52/9dINYHuOcfIm/7vymMoxL8w+Rv/5ckf/u/ERLrzyzyf56e8T5MFp0K/KMC/yJtQwOs/1yAmNI1CLv/ZPZ8UeL8xwR+v++v/IZu/zv9Zk1r/sBOxtf9L9l2vwEvyCnfP8ja/7hgfzfB91T59qMc/6ZJ7v5joib+rcAH8yfY/04K/CzrWDZzjt8+1T/+TQn8fwFQSwECFwsUAAIACADqpCxHe+EzY8MDAAAIJgAACQAJAAAAAAAAAAAAAIAAAAAAVUlQYWNrYWdlVVQFAAeZjfRVUEsFBgAAAAABAAEAQAAAAPsDAAAAAA==


[Script]
//UserVar WorldName = "WorldA" "世界名称"
//UserVar WorldName = DropList{"Eden":"WorldE"|"Tinker":"WorldT"|"Pelago":"WorldP"|"Spyre":"WorldS"|"Aspen":"WorldA"} "世界名称"
BlockCount = 0


WorldName = "WorldP"
BreakPoint = False

CaveSub = 121
CaveSup = 132
FossilSub = 149
FossilSup = 160


Call Lib.CC.Initailize()

dm_ret = dm.BindWindow(handle, "dx2", "dx2", "dx", 0)
Delay 100
Dm.SetPath "C:\Users\Administrator\Documents\DmRes"'大漠全局路径设置

Rem Start

For Index = 1 To 50

Call TPMine(WorldName,Index)
Call JumpForward
Call WaitInnerWorld
Call Hunt
Call WaitOverWorld


Next






Sub TPMine(WorldName, MineIndex)
Dim MyString, MyArray
MinePos = Lib.文件.读取指定行文本内容("C:\Users\Administrator\Documents\DmRes\" & WorldName & ".txt",MineIndex)
If MinePos = "" Then 
//EndScript
Goto Start
Else 
	MyString = Split(MinePos, ",", - 1 , 1)
	MineX = CSng(MyString(0))
	MineY = CSng(MyString(1))
	MineZ = CSng(MyString(2))
	
	返回值 = Lib.CC.TP(MineX, MineY, MineZ)
	Delay 1000
End If
	
	
End Sub


Sub JumpForward

Delay 200
dm.KeyDownChar "W"
Delay 16
dm.KeyDownChar "Space"
Delay 219
dm.KeyUpChar "Space"
Delay 31
dm.KeyUpChar "W"
Delay 200

End Sub


Sub Hunt

SubAddress = dm.ReadInt(handle, "[[<Cubic.exe>+2AC330]+704]+14C", 0)
Call Lib.CC.GetWorldSize()
Call Lib.CC.SetCamera(0,89)

Dim MyArray(1), Addresses
MyArray(0) = CStr(Hex(SubAddress + 18))
MyArray(1) = CStr(Hex(SubAddress + SizeX*SizeY*SizeZ*18))
MyRange = Join(MyArray, "-")

TargetAdsArr = dm.FindIntEx(handle, MyRange, CaveSub, CaveSup, 2, 18, 0, 0) & "|" & dm.FindIntEx(handle, MyRange, FossilSub, FossilSup, 2, 18, 0, 0)

Addresses = Split(TargetAdsArr, "|")

Lock = 0

For Each I In Addresses
	BlockID = AdrToPos(I,0)
	BlockType = AdrToPos(I, 1) Mod 8
	If BlockType = 1 And BlockID <> 134 Then 
		X = AdrToPos(I, 2)
		Y = AdrToPos(I, 4)
		Z = AdrToPos(I, 6)
		Lock = 1
		BlockCount = BlockCount + 1
		If BlockID > 120 And BlockID < 133 Then 
			Block = "CaveArt!!!"
			Else 
			Block = "Fossil!!!"
		End If
		Goto TP
	End If
Next


Goto SkipHunting
Rem TP
For i = Y To SizeY - 1
For j = 40 To Z - 1
	Call Lib.CC.WriteBlock(X, i ,j, 0)
Next
Next

Call Lib.CC.TP(X, Y -.2, Z - 1)
Delay 500
//Call Plugin.Bkgnd.LeftClick(handle, 640, 480)
dm.MoveTo 640, 480
dm.LeftClick
Delay 50

Dk = 50
	While Lib.CC.ReadBlock(X , Y -1 , Dk) = 0 And Dk - SizeZ  < 0
		Dk = Dk + 1
		Delay 100
	Wend
Delay 200
Call Lib.CC.TP(X, Y - 1, Dk - 1)

If BreakPoint Then
	dm.WaitKey 115, 0
	Goto SkipHunting
End If
Delay 500

Rem SkipHunting
//Call Plugin.Bkgnd.LeftClick(handle, 1256, 22)
dm.MoveTo 1256, 22
dm.LeftClick
Delay 100
//Call Plugin.Bkgnd.LeftClick(handle, 560, 536)
dm.MoveTo 560, 536
dm.LeftClick
Delay 100
End Sub


Sub WaitInnerWorld
intX = 0	
Do
dm_ret = dm.FindPic(0, 0, 2000, 2000, "ExitWorld.bmp", "000000", 0.9, 2, intX, intY)
Delay 200
Loop While intX < 0

End Sub


Sub WaitOverWorld

intX = 0
Do
dm_ret = dm.FindPic(0, 0, 2000, 2000, "SkyMap.bmp", "000000", 0.9, 2, intX, intY)
Delay 200
Loop While intX < 0

End Sub


Function AdrToPos(adr, off)
	Dim Arr(1)
	Arr(0) = adr
	Arr(1) = CStr(off)
	PStr = Join(Arr,"+")
	AdrToPos = dm.ReadInt(handle,PStr,2)
End Function

Sub OnScriptExit
	MessageBox BlockCount
End Sub
